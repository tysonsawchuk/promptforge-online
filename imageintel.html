          <div class="hud">
            <div class="chip" id="status-models">models: –</div>
            <div class="chip" id="status-fps">fps: –</div>
            <div class="chip" id="status-size">– × –</div>
          </div>
        </div>
        <div class="outpanel">
          <div class="kpi">
            <div class="card" id="kpi-subject">Subject: —</div>
            <div class="card" id="kpi-pose">Pose: —</div>
            <div class="card" id="kpi-objects">Objects: —</div>
            <div class="card" id="kpi-light">Lighting: —</div>
            <div class="card" id="kpi-color">Palette: —</div>
          </div>
          <textarea id="prompt" placeholder="Replica prompt will appear here…"></textarea>
        </div>
      </div>

      <div class="terminal" id="terminal"></div>
    </div>

    <footer>
      <div>Drop-in static build. No backend. <span id="ads">[ads hook]</span></div>
    </footer>
  </div>

  <!-- Vendor libs for optional NSFW classification (not used yet) -->
  <script defer src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0/dist/tf.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@nsfw-filter/nsfwjs@2.6.0/dist/nsfwjs.min.js"></script>

  <!-- Main app module: wires UI + object detector overlay (CDN WASM) -->
  <script type="module">
    import { boot, log, setVersion } from './public/imageintel/js/helpers.js';
    import { detectOnImage } from './public/imageintel/js/object_detector.js';
    import { generatePrompt } from './public/imageintel/js/prompts.js';
    import { analyzeColors } from './public/imageintel/js/color.js';

    setVersion('v0.1.0-alpha');
    boot({ logEl: document.getElementById('terminal') });

    const img = document.getElementById('input');
    const file = document.getElementById('file');
    const demo = document.getElementById('demo');
    const mode = document.getElementById('mode');
    const prompt = document.getElementById('prompt');

    function onImageReady(){
      document.getElementById('status-size').textContent = `${img.naturalWidth} × ${img.naturalHeight}`;
      log('io', 'image ready');
      // Run object detection overlay
      detectOnImage(img).then(()=>{
        // Basic color/lighting read + prompt
        const colors = analyzeColors(img);
        document.getElementById('kpi-light').textContent = `Lighting: ${colors.temperature} • ${colors.brightness}`;
        document.getElementById('kpi-color').textContent = `Palette: ${colors.palette.join(', ')}`;
        const out = generatePrompt({
          mode: mode.value,
          detail: 2,
          readings: {
            subject: 'photo subject',
            pose: 'pose from detector (later)',
            objects: document.getElementById('kpi-objects').textContent.replace('Objects: ','') || 'none',
            lighting: `${colors.temperature} / brightness ${colors.brightness}`,
            colors: colors.palette,
            stats: { contrast: colors.contrast }
          }
        });
        prompt.value = out;
      });
    }

    file.addEventListener('change', e=>{
      const f = e.target.files[0]; if(!f) return;
      const url = URL.createObjectURL(f);
      img.onload = onImageReady; img.src = url;
    });

    demo.addEventListener('click', ()=>{
      img.onload = onImageReady;
      img.src = 'https://images.unsplash.com/photo-1531123897727-8f129e1688ce?q=80&w=1280&auto=format';
      log('io', 'loaded demo image');
    });

    mode.addEventListener('change', ()=>{ if(img.naturalWidth) onImageReady(); });
  </script>
</body>
</html>
