<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ImageIntel — Smoke Test A (inline JS + file load)</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;background:#0c1016;color:#e9f3ff;margin:0;padding:16px}
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .card{background:#101723;border:1px solid #1a2331;border-radius:12px;padding:12px}
    img{max-width:100%;height:auto;display:block;background:#0b1522;border-radius:8px}
    pre{background:#0a1220;border:1px solid #1f2a3d;border-radius:8px;padding:10px;min-height:120px;white-space:pre-wrap}
    button,input{background:#162233;color:#cfe7ff;border:1px solid #233146;border-radius:10px;padding:.6rem .9rem;font-weight:700}
  </style>
</head>
<body>
  <h1>Smoke Test A <span style="font-size:.8rem;border:1px solid #a98eff;color:#a98eff;padding:.1rem .4rem;border-radius:.4rem">v0</span></h1>
  <p>If you see “JS running ✓” below and you can load a local image into the preview, then inline JS is allowed here.
     If not, your CSP is blocking scripts and that’s why the big page does nothing.</p>

  <div class="row">
    <div class="card">
      <h3>1) Pick a local image</h3>
      <input type="file" id="file" accept="image/*;capture=camera" />
      <p id="meta">No image</p>
      <img id="preview" alt="preview will appear here" />
    </div>
    <div class="card">
      <h3>2) Diagnostics</h3>
      <pre id="diag"></pre>
      <button id="copy">Copy Diag</button>
    </div>
  </div>

  <!-- Inline JS on purpose (to test CSP) -->
  <script>
    const log = (m)=>{ const d=document.getElementById('diag'); d.textContent += (d.textContent?'\n':'') + m; };
    log('JS running ✓'); // <— If you do NOT see this, scripts are blocked by CSP.

    // Minimal loader (no external URLs, no CORS): just show a local file
    document.getElementById('file').addEventListener('change', e=>{
      const f = e.target.files && e.target.files[0];
      if(!f){ log('No file'); return; }
      const url = URL.createObjectURL(f);
      const img = document.getElementById('preview');
      img.onload = ()=>{ document.getElementById('meta').textContent = `${f.name} — ${img.naturalWidth}×${img.naturalHeight}`; log('Loaded local file ✓'); };
      img.onerror = ()=>{ log('Image failed to load'); };
      img.src = url;
    });

    document.getElementById('copy').onclick = async ()=>{
      try { await navigator.clipboard.writeText(document.getElementById('diag').textContent||''); log('Diag copied'); }
      catch(e){ log('Clipboard failed: '+e.message); }
    };
  </script>
</body>
</html>
